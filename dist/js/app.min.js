(()=>{"use strict";const t=new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short",year:"numeric"}),e=e=>{const r=document.createElement("li");r.classList.add("repo");const n=t.format(new Date(e.updated_at));var o;if(r.innerHTML=`\n\t\t<h3 class="repo-creator">\n\t\t\tby <a target="_blank" href="${e.owner.html_url}">${e.owner.login}</a>\n\t\t</h3>\n\n\t\t<h2 class="repo-title">\n\t\t\t<a target="_blank" href="${e.html_url}">\n\t\t\t\t${e.name}\n\t\t\t</a>\n\t\t</h2>\n\n\t\t<div class="repo-updated">updated at: ${n}</div>\n\n\t\t${o=e.description,`\n    <p class="repo-description${o?"":" empty"}">\n\t\t\t${o||"No description available yet.."}\n\t\t</p>\n  `}\n\t`,e.topics.length){const t=document.createElement("ul");t.classList.add("repo-topics");for(let r of e.topics){const e=document.createElement("li");e.classList.add("repo-tag"),e.textContent=r,t.append(e)}r.append(t)}else r.append(document.createElement("br"));return r},r=new function(t){this.url=new URL("https://api.github.com/search/repositories"),this.url.searchParams.set("per_page",10),this.controller=null,this.loading=!1,this.lastQuery="",this.errorStatus=0,this.getItems=async function(t){this.lastQuery=t,this.errorStatus=0,this.url.searchParams.set("q",t),this.controller&&this.controller.abort(),this.controller=new AbortController,this.loading=!0;try{const t=await fetch(this.url.href,{signal:this.controller.signal});if(!t.ok)return this.loading=!1,this.errorStatus=t.status,void console.log(`Error code: ${this.errorStatus}`);const e=await t.json();return this.controller=null,this.loading=!1,e.items}catch(t){if("AbortError"==t.name)return void console.log("Aborted!");throw t}}}("https://api.github.com/search/repositories"),n=async(t,n,o=".message",s=".spinner")=>{const i=document.querySelector(o),a=document.querySelector(s);if(t===r.lastQuery)return;n.innerHTML="",i.hidden=!0,a.hidden=!1;const l=await r.getItems(t);if(!r.loading){if(a.hidden=!0,r.errorStatus)return i.hidden=!1,void(i.textContent=`Something went wrong.. Error status: ${r.errorStatus}`);if(0===l.length)return i.hidden=!1,void(i.textContent="No results found.. Try another search");for(let t of l)n.append(e(t))}};!function(t){let e=new Image;e.onload=e.onerror=function(){!function(t){let e=1==t?"webp":"no-webp";document.querySelector("body").classList.add(e)}(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}(),document.querySelector(".switcher").onclick=()=>{let t=document.body.dataset.theme;document.body.dataset.theme="light"===t?"dark":"light"};const o=document.forms.form,s=document.querySelector(".repo-list"),i=o.elements.repo,a=document.querySelector(".search-error");o.onsubmit=t=>{t.preventDefault();const e=i.value.trim();e&&(e.length<3?a.hidden=!1:n(e,s))},i.oninput=()=>{a.hidden||(a.hidden=!0)},s.onclick=t=>{const e=t.target.closest("li.repo-tag");if(!e)return;let r=`in:topics ${e.textContent}`;i.value=r,n(r,s)}})();